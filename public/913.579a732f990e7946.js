"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[913],{4913:(D,m,i)=>{i.r(m),i.d(m,{ReportsSalesModule:()=>P});var g=i(9808),d=i(9735),u=i(4004),k=i(590),_=i(573),y=i(6469),p=i(953),x=i(833);var Z=i(1998);function A(a,n){(0,x.Z)(1,arguments);var e=n||{},o=e.locale,r=o&&o.options&&o.options.weekStartsOn,s=null==r?0:(0,Z.Z)(r),c=null==e.weekStartsOn?s:(0,Z.Z)(e.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=(0,p.Z)(a),f=l.getDay(),S=(f<c?7:0)+f-c;return l.setDate(l.getDate()-S),l.setHours(0,0,0,0),l}function M(a,n){(0,x.Z)(1,arguments);var e=n||{},o=e.locale,r=o&&o.options&&o.options.weekStartsOn,s=null==r?0:(0,Z.Z)(r),c=null==e.weekStartsOn?s:(0,Z.Z)(e.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=(0,p.Z)(a),f=l.getDay(),S=6+(f<c?-7:0)-(f-c);return l.setDate(l.getDate()+S),l.setHours(23,59,59,999),l}function C(a){(0,x.Z)(1,arguments);var n=(0,p.Z)(a),e=n.getMonth();return n.setFullYear(n.getFullYear(),e+1,0),n.setHours(23,59,59,999),n}function h(a){(0,x.Z)(1,arguments);var n=(0,p.Z)(a);return n.setDate(1),n.setHours(0,0,0,0),n}function F(a){(0,x.Z)(1,arguments);var n=(0,p.Z)(a),e=n.getFullYear();return n.setFullYear(e+1,0,0),n.setHours(23,59,59,999),n}function O(a){(0,x.Z)(1,arguments);var n=(0,p.Z)(a),e=new Date(0);return e.setFullYear(n.getFullYear(),0,1),e.setHours(0,0,0,0),e}var t=i(5e3),b=i(9763),T=i(1221),v=i(7805),Y=i(9828);function B(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",16),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("type","Sales Today"==e.activeButton?"default":"normal")}}function N(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",17),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("type","Sales this Week"==e.activeButton?"default":"normal")}}function J(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",18),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("type","Sales this Month"==e.activeButton?"default":"normal")}}function U(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",19),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("type","Sales last Month"==e.activeButton?"default":"normal")}}function H(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",20),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("type","Sales this Year"==e.activeButton?"default":"normal")}}function q(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",21),t.NdJ("onClick",function(r){return t.CHM(e),t.oxw().filterClicked(r)}),t.qZA(),t.qZA()}}function E(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",22),t.NdJ("onClick",function(){return t.CHM(e),t.oxw().generateReport()}),t.qZA(),t.qZA()}}const Q=[{path:"",component:(()=>{class a{constructor(e,o){this.salesService=e,this._activatedRoute=o,this.sales=[]}ngOnInit(){this.salesService.getAll().pipe((0,u.U)(e=>e.map(o=>(o.total=this._caculateProductTotal(o.price,o.quantity,o.discount),o.createdDate=new Date(+o.createdDate),o))),(0,k.P)()).subscribe(e=>{this.sales=e,this._activatedRoute.snapshot.queryParams.activeButton&&(this.activeButton=this._activatedRoute.snapshot.queryParams.activeButton,setTimeout(()=>this._filterByActiveButton()))})}_caculateProductTotal(e,o,r){return r?e*o-r/100*e:e*o}filterClicked(e){this.activeButton=e.component.option("text"),this._filterByActiveButton()}_filterByActiveButton(){switch(this.activeButton){case"Sales Today":this.dxDataGrid.instance.filter([["createdDate","<",+(0,y.Z)()],"and",["createdDate",">",+function R(a){(0,x.Z)(1,arguments);var n=(0,p.Z)(a);return n.setHours(0,0,0,0),n}(Date.now())]]);break;case"Sales this Week":this.dxDataGrid.instance.filter([["createdDate","<",+A(new Date)],"and",["createdDate",">",+M(new Date)]]);break;case"Sales this Month":this.dxDataGrid.instance.filter([["createdDate","<",+C(new Date)],"and",["createdDate",">",+h(new Date)]]);break;case"Sales this Year":this.dxDataGrid.instance.filter([["createdDate","<",+F(new Date)],"and",["createdDate",">",+O(new Date)]]);break;case"Sales last Month":case"Sales this Month":const e=new Date,o=new Date(e.getFullYear(),e.getMonth()-1,1);this.dxDataGrid.instance.filter([["createdDate","<",+C(o)],"and",["createdDate",">",+h(o)]]);break;default:this.dxDataGrid.instance.filter(null)}}generateReport(){this.dxDataGrid.instance.exportToExcel(!1)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(b.M),t.Y36(d.gz))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-reports-sales"]],viewQuery:function(e,o){if(1&e&&t.Gf(_.e,5),2&e){let r;t.iGM(r=t.CRH())&&(o.dxDataGrid=r.first)}},hostAttrs:[1,"default-app-style"],decls:30,vars:6,consts:[[1,"text-6xl","mb-6"],["keyExpr","id",1,"shadow-xl",3,"dataSource"],["fileName","sales-report",3,"enabled"],[3,"allowUpdating","allowDeleting","allowAdding"],[3,"visible"],["location","before","name","groupPanel"],["location","after"],[4,"dxTemplate"],["dataField","invoiceNumber","caption","Invoice Number"],["dataField","name","caption","Cashier"],["dataField","productName","caption","Product"],["dataField","price","caption","Price"],["dataField","quantity","caption","Quantity"],["dataField","discount","caption","Discount"],["dataField","total","caption","Total"],["dataField","createdDate","caption","Transaction Date","dataType","datetime"],["text","Sales Today",3,"type","onClick"],["text","Sales this Week",3,"type","onClick"],["text","Sales this Month",3,"type","onClick"],["text","Sales last Month",3,"type","onClick"],["text","Sales this Year",3,"type","onClick"],["text","All",3,"onClick"],["text","Generate Report","type","default",3,"onClick"]],template:function(e,o){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Sales Reports"),t.qZA(),t.TgZ(2,"dx-data-grid",1),t._UZ(3,"dxo-export",2),t._UZ(4,"dxo-editing",3),t._UZ(5,"dxo-group-panel",4),t.TgZ(6,"dxo-toolbar"),t._UZ(7,"dxi-item",5),t.TgZ(8,"dxi-item",6),t.YNc(9,B,2,1,"div",7),t.qZA(),t.TgZ(10,"dxi-item",6),t.YNc(11,N,2,1,"div",7),t.qZA(),t.TgZ(12,"dxi-item",6),t.YNc(13,J,2,1,"div",7),t.qZA(),t.TgZ(14,"dxi-item",6),t.YNc(15,U,2,1,"div",7),t.qZA(),t.TgZ(16,"dxi-item",6),t.YNc(17,H,2,1,"div",7),t.qZA(),t.TgZ(18,"dxi-item",6),t.YNc(19,q,2,0,"div",7),t.qZA(),t.TgZ(20,"dxi-item",6),t.YNc(21,E,2,0,"div",7),t.qZA(),t.qZA(),t._UZ(22,"dxi-column",8),t._UZ(23,"dxi-column",9),t._UZ(24,"dxi-column",10),t._UZ(25,"dxi-column",11),t._UZ(26,"dxi-column",12),t._UZ(27,"dxi-column",13),t._UZ(28,"dxi-column",14),t._UZ(29,"dxi-column",15),t.qZA()),2&e&&(t.xp6(2),t.Q6J("dataSource",o.sales),t.xp6(1),t.Q6J("enabled",!0),t.xp6(1),t.Q6J("allowUpdating",!1)("allowDeleting",!1)("allowAdding",!1),t.xp6(1),t.Q6J("visible",!0))},directives:[_.e,v.Ak0,v.Uo8,v.Een,v.y1f,v.ZT3,Y.p6,T.K,v.qvW],styles:[""]}),a})()}];let G=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[d.Bz.forChild(Q)],d.Bz]}),a})();var W=i(4043);let P=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[g.ez,G,_.x,T.e,W.k]]}),a})()},1998:(D,m,i)=>{function g(d){if(null===d||!0===d||!1===d)return NaN;var u=Number(d);return isNaN(u)?u:u<0?Math.ceil(u):Math.floor(u)}i.d(m,{Z:()=>g})}}]);