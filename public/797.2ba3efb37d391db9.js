"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[797],{7797:(W,g,i)=>{i.r(g),i.d(g,{StockAdjustmentModule:()=>G});var k=i(9808),x=i(9735),w=i(5861),y=i(5372),r=i(8635),C=i(5128),u=i(4597),c=i(590),T=i(8746),U=i(2386),h=i(7225),t=i(5e3),J=i(4562),P=i(6082),Q=i(2340),b=i(3857),D=i(520);let f=(()=>{class o extends b.b{constructor(e){super(e),this.http=e,this.BASE_ROUTE="adjustmentstock"}adjustStock(e){return this.http.post(`${Q.N.apiUrl}/${this.BASE_ROUTE}`,e,{observe:"response"})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(D.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var v=i(7354),S=i(1221),p=i(573),A=i(7953),d=i(7805),O=i(9828),M=i(4004);const E=function(){return["5","10","15"]};let F=(()=>{class o{constructor(e){this._adjustmentService=e}ngOnInit(){this._adjustmentService.getAll().pipe((0,M.U)(e=>e.map(n=>(n.createdDate=new Date(+n.createdDate),n)))).subscribe(e=>{this.adjustments=e})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stock-adjustment-history"]],decls:8,vars:10,consts:[["width","100%",1,"mb-6",3,"dataSource"],["mode","cell",3,"allowUpdating","allowDeleting","allowAdding"],[3,"visible"],["displayMode","adaptive",3,"visible","allowedPageSizes","showInfo"],["alignment","left","dataField","productName","caption","Product Name",3,"allowEditing"],["dataField","user","caption","Adjusted By","alignment","left"],["dataField","stock","caption","Stock Adjusted","alignment","left"],["dataField","createdDate","caption","Adjusted Date","dataType","date","alignment","left"]],template:function(e,n){1&e&&(t.TgZ(0,"dx-data-grid",0),t._UZ(1,"dxo-editing",1),t._UZ(2,"dxo-filter-row",2),t._UZ(3,"dxo-pager",3),t._UZ(4,"dxi-column",4),t._UZ(5,"dxi-column",5),t._UZ(6,"dxi-column",6),t._UZ(7,"dxi-column",7),t.qZA()),2&e&&(t.Q6J("dataSource",n.adjustments),t.xp6(1),t.Q6J("allowUpdating",!1)("allowDeleting",!1)("allowAdding",!1),t.xp6(1),t.Q6J("visible",!0),t.xp6(1),t.Q6J("visible",!0)("allowedPageSizes",t.DdM(9,E))("showInfo",!0),t.xp6(1),t.Q6J("allowEditing",!0))},directives:[p.e,d.Uo8,d.I62,d.ilc,d.qvW],styles:[""]}),o})();const B=["productsDatagrid"];function H(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"dx-button",25),t.NdJ("onClick",function(){return t.CHM(e),t.oxw().adjustStock()}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("disabled",null===(n=!(null!=e.selectedProducts&&e.selectedProducts.length))||void 0===n||n)}}function I(o,s){if(1&o&&(t.TgZ(0,"div"),t.TgZ(1,"dx-data-grid",26,27),t._UZ(3,"dxo-filter-row",28),t._UZ(4,"dxo-selection",29),t._UZ(5,"dxi-column",15),t._UZ(6,"dxi-column",30),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.products),t.xp6(2),t.Q6J("visible",!0),t.xp6(2),t.Q6J("allowEditing",!1),t.xp6(1),t.Q6J("allowEditing",!1)}}const Z=function(){return{disabled:!0}},L=function(o){return{dataSource:o,displayExpr:"name",valueExpr:"id"}},N=function(){return{of:"body"}},R=[{path:"",component:(()=>{class o extends U.V{constructor(e,n,a){super(),this._supplierService=e,this._productService=n,this._stockAdjustmentService=a,this.showLoading=!1,this.showProducts=!1,this.suppliers=[],this.selectedProducts=[],this.products=[],this.formData={stockInBy:"Mark",stockInDate:(0,y.Z)(new Date,"MMMM dd yyyy h:m bbbb"),supplier:""},this.addProducts={text:"Add Selected Products",onClick:()=>{var l;const j=null===(l=this.productsDatagrid.instance.getSelectedRowsData())||void 0===l?void 0:l.map(m=>({productId:m.id,name:m.name,currentStock:m.stock}));!j.length||(this.selectedProducts.push(...j),this.dxPopup.instance.hide())}}}ngOnInit(){this._supplierService.getAll().pipe((0,c.P)()).subscribe(e=>{this.suppliers=(0,h.Zr)(e)})}showProductBySupplier(){this.showProducts=!0}productListOnHidden(e){this.productsDatagrid.instance.deselectAll(),this.products=null}productListOnShowing(e){this.formData.supplier?this._productService.getProductBySupplier(+this.formData.supplier).pipe((0,c.P)()).subscribe(n=>{this.products=(0,h.Zr)(n)}):e.cancel=!0}adjustStock(){var e=this;return(0,w.Z)(function*(){const n=e.selectedProducts.filter(l=>l.stock);n.length?(n.length!==e.selectedProducts.length&&(0,u.Z)("Some of the selected products stock is/are not adjusted.","error",3e3),(yield(0,C.iG)("Are you sure you want to adjust Quantities?","Adjust Quantity"))&&(e.showLoading=!0,e._stockAdjustmentService.adjustStock(e.selectedProducts).pipe((0,T.x)(()=>e.showLoading=!1),(0,c.P)()).subscribe(()=>{(0,u.Z)("Successfully adjust stocks.","success",3e3)}))):(0,u.Z)("No stock is modified","error",3e3)})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(J.p),t.Y36(P.M),t.Y36(f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stock-adjustment"]],viewQuery:function(e,n){if(1&e&&(t.Gf(B,5),t.Gf(r.x,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.productsDatagrid=a.first),t.iGM(a=t.CRH())&&(n.dxPopup=a.first)}},hostAttrs:[1,"default-app-style"],features:[t.qOj],decls:31,vars:35,consts:[[1,"text-6xl","mb-6"],["width","auto",1,"shadow-xl","p-6",3,"formData","colCount"],["itemType","tabbed"],["width","100%",3,"deferRendering"],["title","Adjustment"],["dataField","stockInBy",3,"colSpan","editorOptions"],["dataField","stockInDate",3,"colSpan","editorOptions"],["dataField","supplier","editorType","dxLookup",3,"colSpan","editorOptions"],["itemType","simple",3,"colSpan"],["text","Click To Browse Product",3,"disabled","onClick"],[1,"text-4xl","my-6"],["width","100%",1,"mb-6",3,"dataSource"],["location","before"],[4,"dxTemplate"],["mode","cell",3,"allowUpdating","allowDeleting","allowAdding"],["dataField","name","caption","Name",3,"allowEditing"],["dataField","currentStock","caption","Current Stocks",3,"allowEditing"],["dataField","stock","caption","Stock to Adjust","dataType","number",3,"allowEditing"],["type","buttons","width","100"],["hint","Remove","icon","mdi mdi-trash-can","name","delete"],["title","History"],["title","Products List","height","100vh","width","100vw","maxWidth","600px","maxHeight","700px",3,"showTitle","visible","showCloseButton","closeOnOutsideClick","visibleChange","onShowing","onHidden"],["widget","dxButton","location","after",3,"options"],[4,"dxTemplate","dxTemplateOf"],["shadingColor","rgba(0,0,0,0.4)","target","#route-content",3,"position","visible","showIndicator","showPane","shading","closeOnOutsideClick"],["text","Adjust Stock",3,"disabled","onClick"],["height","100%","maxWidth","900","keyExpr","id",3,"dataSource"],["productsDatagrid",""],[3,"visible"],["mode","multiple"],["dataField","stock","caption","Current Stocks",3,"allowEditing"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Stock Adjustment"),t.qZA(),t.TgZ(2,"dx-form",1),t.TgZ(3,"dxi-item",2),t._UZ(4,"dxo-tab-panel-options",3),t.TgZ(5,"dxi-tab",4),t._UZ(6,"dxi-item",5),t._UZ(7,"dxi-item",6),t._UZ(8,"dxi-item",7),t.TgZ(9,"dxi-item",8),t.TgZ(10,"dx-button",9),t.NdJ("onClick",function(){return n.showProductBySupplier()}),t.qZA(),t.qZA(),t.TgZ(11,"dxi-item"),t.TgZ(12,"h1",10),t._uU(13,"Selected Products"),t.qZA(),t.TgZ(14,"dx-data-grid",11),t.TgZ(15,"dxo-toolbar"),t.TgZ(16,"dxi-item",12),t.YNc(17,H,2,1,"div",13),t.qZA(),t.qZA(),t._UZ(18,"dxo-editing",14),t._UZ(19,"dxi-column",15),t._UZ(20,"dxi-column",16),t._UZ(21,"dxi-column",17),t.TgZ(22,"dxi-column",18),t._UZ(23,"dxi-button",19),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(24,"dxi-tab",20),t.TgZ(25,"dxi-item"),t._UZ(26,"app-stock-adjustment-history"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"dx-popup",21),t.NdJ("visibleChange",function(l){return n.showProducts=l})("onShowing",function(l){return n.productListOnShowing(l)})("onHidden",function(l){return n.productListOnHidden(l)}),t._UZ(28,"dxi-toolbar-item",22),t.YNc(29,I,7,4,"div",23),t.qZA(),t._UZ(30,"dx-load-panel",24)),2&e&&(t.xp6(2),t.Q6J("formData",n.formData)("colCount",1),t.xp6(2),t.Q6J("deferRendering",!0),t.xp6(2),t.Q6J("colSpan",1)("editorOptions",t.DdM(30,Z)),t.xp6(1),t.Q6J("colSpan",1)("editorOptions",t.DdM(31,Z)),t.xp6(1),t.Q6J("colSpan",2)("editorOptions",t.VKq(32,L,n.suppliers)),t.xp6(1),t.Q6J("colSpan",2),t.xp6(1),t.Q6J("disabled",!n.formData.supplier),t.xp6(4),t.Q6J("dataSource",n.selectedProducts),t.xp6(4),t.Q6J("allowUpdating",!0)("allowDeleting",!0)("allowAdding",!1),t.xp6(1),t.Q6J("allowEditing",!1),t.xp6(1),t.Q6J("allowEditing",!1),t.xp6(1),t.Q6J("allowEditing",!0),t.xp6(6),t.Q6J("showTitle",!0)("visible",n.showProducts)("showCloseButton",!0)("closeOnOutsideClick",!1),t.xp6(1),t.Q6J("options",n.addProducts),t.xp6(1),t.Q6J("dxTemplateOf","content"),t.xp6(1),t.Q6J("position",t.DdM(34,N))("visible",n.showLoading)("showIndicator",!0)("showPane",!0)("shading",!0)("closeOnOutsideClick",!1))},directives:[v.Y,d.ZT3,d.l6j,d.v0s,S.K,p.e,d.y1f,O.p6,d.Uo8,d.qvW,d.k4o,F,r.x,d.QjJ,d.I62,d.Lz9,A.Z],styles:[""]}),o})()}];let z=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[x.Bz.forChild(R)],x.Bz]}),o})();var Y=i(4448);let G=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[k.ez,z,v.A,p.x,r.C,Y.n,S.e,A.p]]}),o})()}}]);